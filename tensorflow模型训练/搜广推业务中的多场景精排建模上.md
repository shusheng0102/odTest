今天起，和大家分享一下最近几年兴起的搜广推业务中精排模型的一个建模方向-多场景建模，整个介绍会分为上、中、下三个部分。这是第一部分。

1. **多场景建模定义**

   通常每个互联网app都会有多个不同的业务入口，来满足用户的多样化的需求，例如美团外卖app首页会有多个美食入口金刚位，淘宝有首页信息流、商品详情页信息流等。多场景精排建模就是用一个统一的模型，对用户在多个不同场景下的候选item进行排序。

**2. 为什么要进行多场景统一建模**

* 第一，每个场景单独建模需要维护多个模型，耗费更多人力和算力；
* 第二，单独建模无法捕捉到场景间的可迁移知识，对于一些数据量小的场景，单独建模很难获取比较好的模型泛化能力。

**3. 工业界如何做多场景建模**

接下来和大家分享一下阿里、美团、华为、快手等公司如何做多场景建模。多场景建模的核心是怎么通过模型来表达多个场景的共性和差异性。多个场景在数据分布上会存在一定的差异性，包括正样本的比例、以及user和item的分布等。
**3.1 阿里的做法**

**Star模型**

* 阿里妈妈提出的star模型针对多场景的广告ctr预估，首先在Embedding层是所有场景共享的，其次在Dense层，每个场景有一个单独的塔，场景塔的参数只有场景对应的样本进行更新，有一个多场景共享的塔，塔的参数所有场景的样本都会更新，也就是说单独塔学习每个场景的独立数据分布，共享塔学习全局数据分布，最终将场景塔和全局塔乘起来再得到最终某个场景的预估值，这样既学习单场景的个性，又学习多场景的共性。

![图片](https://mmbiz.qpic.cn/mmbiz_png/3dibQV3VCIyiaCSCzXvUUFXEy80KBujVJI9chgu6dGTJlbhMtsIQwaeStnkcTfeUro3yJiaNfgspewYfYHHwxf6NQ/640?wx_fmt=png&from=appmsg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1)

HC^2模型


* HC^2模型的核心思想是通过对比学习来更好的学习场景独有知识和场景共享知识。文中增加了全场景通用对比损失和单场景个性化对比损失。对比学习的正负样本基于不同场景和不用label来构建。

![图片](https://mmbiz.qpic.cn/mmbiz_png/3dibQV3VCIyiaCSCzXvUUFXEy80KBujVJIMKiaqZibvanpzq8ouZDhbSqPlT7UgiauxowmmXZiaUyemeTkRHicJpDfrOQ/640?wx_fmt=png&from=appmsg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1)

**Maria模型**

* Maria模型的核心思想是放大一些场景相关的特征的作用，首先，直接注入到Embedding层，做到同一ID的embedding在不同场景的差异化；其次，通过场景相关特征和共享专家网络，从而方便在多场景之间进行信息传递。

![图片](https://mmbiz.qpic.cn/mmbiz_png/3dibQV3VCIyiaCSCzXvUUFXEy80KBujVJIQPkludXovibtXh6fPGQaMSR77O1HhtJrGXBuL3ODOQpg51aI9GpAopQ/640?wx_fmt=png&from=appmsg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1)

**3.2 美团的做法**

**HiNet模型**

* 核心特点是针对多场景设计了SAN模块，通过场景相关特征、注意力机制、moe网络结构，从而更方便地在不同场景之间进行信息传递。

![图片](https://mmbiz.qpic.cn/mmbiz_png/3dibQV3VCIyiaQZwzV1NosGLE4IdmicYDNlibxvXosSN8oiayvK0c9v59NSJTWjqIkelTVkEOXdtmtmBrXCNG7eRzrw/640?wx_fmt=png&from=appmsg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1)

**3.3 华为的做法**

**DFFM模型**

* 核心想法有两点，第一，根据场景特征生成dense层网络的权重，和场景无关特征通过dense层网络进行特征交叉建模；第二，通过多头自注意力机制在用户历史行为序列建模时引入场景特征。

![图片](https://mmbiz.qpic.cn/mmbiz_png/3dibQV3VCIyiaQZwzV1NosGLE4IdmicYDNl7QhJPyT5B3Gr5JxJI9iaLsgVUFcj8jE5Noo0ribmr7rrbUMCI4Pq9axg/640?wx_fmt=png&from=appmsg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1)

**3.4 快手的做法**

* 核心思想是在Embedding层通过门控网络注入场景相关特征，实现不同场景下的差异化表征，与阿里的Maria模型做法有一定的相似性。

![图片](https://mmbiz.qpic.cn/mmbiz_png/3dibQV3VCIygkcqksbyPSkXWCpEZ8RPeiabnOnia2IY4AoBVCW3yf7jaZDdmp5LSlFfYOLNUice9nAiczXpObgZyt7g/640?wx_fmt=png&from=appmsg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1)

**4. 小结**

互联网公司的产品都是处于不断更新迭代中，其中伴随着新场景的诞生和老场景的消亡，多场景精排模型也要能灵活应对这种变化。内卷时代，算法工程师们也要思考如何更高效地应对指标提升的压力。
